async function e(e){const t=await fetch(" https://api.spotify.com/v1/me/player/currently-playing",{headers:{Authorization:"Bearer "+e}});(await t.json()).is_playing?async function(e){fetch("https://api.spotify.com/v1/me/player/pause",{method:"PUT",headers:{Authorization:"Bearer "+e}})}(e):async function(e){fetch("https://api.spotify.com/v1/me/player/play",{method:"PUT",headers:{Authorization:"Bearer "+e}})}(e)}BdApi.injectCSS("discordify-styles","#discordSpotifySidebar {\n  background-color: red;\n}");const{React:t,ReactDOM:o}=BdApi,n=BdApi.findModuleByProps("getActiveSocketAndDevice"),a=BdApi.findModuleByProps("SpotifyAPI");function i(){const[i,c]=t.useState(!0),[s,r]=t.useState(""),[l,d]=t.useState({}),[p,m]=t.useState([]),[u,y]=t.useState(!1);t.useEffect((()=>{const{socket:{accountId:e}}=n.getActiveSocketAndDevice();a.getAccessToken(e).then((e=>r(e.body.access_token)))}),[]);t.useEffect((()=>{if(s){(async function(e){const t=await fetch("https://api.spotify.com/v1/me",{headers:{Authorization:"Bearer "+e}});return await t.json()})(s).then((e=>d(e)));(async function(e){const t=[];let o="https://api.spotify.com/v1/me/playlists?limit=50";for(;o;){const n=await fetch(o,{method:"GET",headers:{Authorization:"Bearer "+e}}),a=await n.json();t.push(...a.items);o=a.next}return t})(s).then((e=>m(e)))}}),[s]);return t.createElement(t.Fragment,null,o.createPortal(t.createElement("button",{onClick:()=>c(!i)},"toggle"),document.getElementById("discordSpotifyToolbar")),!i&&t.createElement("div",null,l.display_name&&t.createElement("p",null,"Fuck off ",l.display_name),t.createElement("button",{onClick:()=>async function(e){fetch("https://api.spotify.com/v1/me/player/previous",{method:"POST",headers:{Authorization:"Bearer "+e}})}(s)},"backwards"),t.createElement("button",{onClick:()=>e(s)},"play/pause"),t.createElement("button",{onClick:()=>async function(e){fetch("https://api.spotify.com/v1/me/player/next",{method:"POST",headers:{Authorization:"Bearer "+e}})}(s)},"forwards"),t.createElement("button",{onClick:()=>y(!u)},"toggle playlists"),u&&t.createElement("div",{id:"playlistContainer",style:{width:"400px",overflowY:"scroll",userSelect:"text",height:"400px"}},p.map((e=>t.createElement("p",null,JSON.stringify(e)))))))}module.exports=class{load(){console.log("test")}start(){!function(){const e=document.createElement("div");e.id="discordSpotifyToolbar";document.getElementsByClassName("toolbar-1t6TWx")[0].append(e);const t=document.createElement("div");t.id="discordSpotifySidebar";document.getElementsByClassName("container-2lgZY8")[0].append(t)}();o.render(t.createElement(i,null),document.getElementById("discordSpotifySidebar"))}stop(){!function(){document.getElementById("discordSpotifySidebar")?.remove();document.getElementById("discordSpotifyToolbar")?.remove()}()}};
